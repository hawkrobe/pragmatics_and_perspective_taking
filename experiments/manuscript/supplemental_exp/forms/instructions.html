
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/favicon.ico">

    <title>Experiment</title>

    <!-- Bootstrap core CSS -->
    <link href="/lib/css/bootstrap.min.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- Custom styles for this template -->
    <!-- <link href="theme.css" rel="stylesheet"> -->
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
  </head>
  
  <body role="document">
    
    <div class="container theme-showcase" role="main">
      
      </br>
      <div class="progress">
        <div class="progress-bar" role="progressbar" aria-valuenow="5"
	     aria-valuemin="0" aria-valuemax="100" style="width: 5%;">
	  <span class="sr-only">5% Complete</span>
	</div>
      </div>
      
      <div class="page-header">
        <h1>Instructions</h1>
      </div>

      <div class="well" style="width:800px; margin: 0 auto">
	
	<h2><center>The Matching Game</center>  </h2>

	<p>
	  In this experiment you will play a matching game with a
	  computer! One of you will be assigned the <b>Speaker</b> role
	  and the other will be the <b>Listener</b>. On each round of
	  the game, we will randomly pick a few simple objects like
	  these:
	</p>
	
	<p>
	  <center>
	    <img src="images/all_objs.png" alt="Example objects"
		 style="width:300px; height:300px">
	  </center>
	</p>
	
	<p>
	  and place them in a grid of cubby-holes between your point
	  of view (shown on your screen) and your partner's point of
	  view. Although you will see a 2D view in the game, you can
	  imagine you are sitting across the table from your partner:
	</p>

	<p>
	  <center>
	    <img src="images/3d_grid.png" alt="3D grid of objects"
		 style="width:300px; height:300px">
	  </center>
	</p>

	<p>
	  One of the objects in the grid is the <b>target</b>. Only
	  the Speaker can see which object is the target (outlined in
	  orange):
	</p>
	
	<p>
	  <center>
	    <img src="images/targetScreen.png" alt="Example of target"
		 style="width:300px; height:300px">
	  </center>
	</p>
	
	<p>
	  The goal of the Speaker is to send a message so that the
	  Listener can figure out which object is the target.
	</p>
	
	<p>
	  The goal of the Listener is to identify the target based on
	  the message sent by the Speaker. If you are the Listener,
	  you will first need to wait until the Speaker has sent their
	  message before being able to click on the object you think
	  they're telling you about. You'll both get <b> a bonus of
	  $0.01 for each correct response</b>, so pay attention and be
	  careful!
	</p>

	<p>
	  Once the Listener clicks on the object they believe is the
	  target, both players will be given feedback: the Speaker
	  will see what the Listener clicked, and the Listener will
	  see the true target. Then you will both automatically
	  advance to the next round of objects. There are a total
	  of <b>28 rounds</b>. After the final round you will answer a
	  few more questions and be on your way.
	</p>

	<h3> Hidden objects </h3>
	
	<p>
	  What makes this game more interesting is that
	  <b>curtains</b> will appear in some cells. These curtains
	  <b>block the view of the Speaker</b>, who cannot know what
	  object, if any, is behind the curtain. To illustrate, here
	  is the Speaker's view and Listener's view of the same grid,
	  side by side. The Listener can see that there is a green
	  circle on their side of the curtain, but the Speaker does
	  not know it is there.
	</p>
	
	<p>
	  <center>
	    <img src="images/speaker_view.png" alt="speaker view" style="width:600px;height:305px">
	    <hr>
	    <img src="images/listener_view.png" alt="listener view" style="width:600px;height:305px">
	  </center>
	</p>
		
	<p>
	  Finally, please DO NOT refresh the page at any point once
	  you start the game. If you refresh, you will not be able to
	  rejoin the game you were in and you may not be able to
	  submit the HIT. <br> Thank you!
	</p>

	<h3>Please fill out this short quiz below before getting started.</h3>
	<h3>Good luck and have fun!</h3>
      </div>

      <div class="page-header">
        <h3>Comprehension Quiz</h3>
      </div>

      <div class="well" style="width:800px; margin: 0 auto">
	
	<br>
	The <b>speaker</b> can click on an object to end the round.
	<br>
	<input type="radio" name="dgoal" value="no"> True
	<br>
	<input type="radio" name="dgoal" value="yes"> False
	<br>


	<br>
	The <b>listener</b> wants to click on the object that the speaker is
	telling them about.
	<br>
	<input type="radio" name="mgoal" value="yes"> True
	<br>
	<input type="radio" name="mgoal" value="no"> False
	<br>

	<br>
	There are 500 rounds of the game.
	<br>
	<input type="radio" name="message" value="no"> True
	<br>
	<input type="radio" name="message" value="yes"> False
	<br>

	<br>
	The speaker knows about every object in the listener's view.
	<br>
	<input type="radio" name="comp" value="no"> True
	<br>
	<input type="radio" name="comp" value="yes"> False
	<br>

	<br>
	If a square in the grid has a curtain, it means
	<br>
	<input type="radio" name="location" value="no"> The <strong> Listener cannot </strong> see the object.
	<br>
	<input type="radio" name="location" value="yes"> The <strong> Speaker cannot </strong> see the object.
	<br>
	<input type="radio" name="location" value="no"> Both players <strong> can </strong> see the object.
	<br>

	<br>
	Have you participated in this study before?
        <br>
        <input type="radio" name="completed" value="no"> Yes
        <br>
        <input type="radio" name="completed" value="yes"> No
        <br>

	<br>
	<input id="quiz_submit" type="submit" value="Submit">
	<br>
	<br>
	<div class="error" style="display:none"> Ooops! Looks like you made a mistake. You have one more try. </div>
      </div> <!-- /container -->
    </div>

    <script type="text/javascript">
      $('html,body').scrollTop(0);
      var urlParams;
	var match,
	      pl     = /\+/g,  // Regex for replacing addition symbol with a space
	      search = /([^&=]+)=?([^&]*)/g,
	      decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
	      query  = location.search.substring(1);

      urlParams = {};
      while (match = search.exec(query))
      urlParams[decode(match[1])] = decode(match[2]);

      console.log(urlParams)

      var counter = 0;
      document.getElementById("quiz_submit").onclick = function () {
        var ans1 = $('input[name="dgoal"]:checked').val();
        var ans2 = $('input[name="mgoal"]:checked').val();
        var ans3 = $('input[name="message"]:checked').val();
        var ans4 = $('input[name="comp"]:checked').val();
        var ans5 = $('input[name="location"]:checked').val();
        var ans6 = $('input[name="completed"]:checked').val();

        if(ans1 == "yes" && ans2 == "yes" && ans3 == "yes" && 
           ans4 == "yes" && ans5 == "yes" && ans6 == "yes") { 
           var workerId = urlParams.workerId;
           var assignmentId = urlParams.assignmentId;
           var hitId = urlParams.hitId;
           var turkSubmitTo = urlParams.turkSubmitTo;
           location.replace("./pass.html?workerId=" + workerId
                            + "&assignmentId=" + assignmentId
                            + "&hitId=" + hitId + "&turkSubmitTo=" + turkSubmitTo);
        } else if(counter == 3) {
          location.replace("./fail.html");
        } else {
          $('.error').show()
          counter += 1;
        }
      };
    </script>

    <script src="./validate-form.js"></script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <script src="/lib/js/bootstrap.min.js"></script>
  </body>
</html>
